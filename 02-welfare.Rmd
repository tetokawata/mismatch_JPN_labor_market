# 厚生分析:時系列比較

- 1963年から2020年までの年次データ、@kawata2021first の手法を用いて、求職者の厚生変化を記述する

## 方法

- 同質な求職者・求人からなるモデルを用いて、識別のアイディアを紹介する。

  - @kawata2021first では異質性を導入・非定常であったとしても、同じ識別結果を得れることを示している

- 標準的なDiamond-Mortencen-Pissarides型サーチモデル[@rogerson2005search]に準じて、以下の4条件式を仮定する

1. 失業者の価値関数は以下で定義される。

$$rU=b+\underbrace{\Delta}_{サーチ活動の余剰}$$

ただし

$$\Delta = \underbrace{\frac{m}{u}}_{入職率}\times \underbrace{(W-U)}_{入職からの余剰}$$

$m:$ 新規就職件数、$u:$求職者数、$U:$求職者の期待効用、$W:$就業者の期待効用、$r,b:$ パラメータ

- 総余剰をデータから識別することを目指す。

  - 同値はサーチ活動がもたらす期待余剰であり、入職率と入職がもたらす余剰$W-U$の積として定義されている。
  
  - 識別の障害となるのは、入職からの余剰をデータから直接観察できない点にある。以下では他の均衡条件を用いることで、この観察できない値の”変化”は復元できることを示している。

2. 求人の価値関数は以下で定義される。

$$rV=-k+\frac{m}{v}\times (J-V)$$

$v:$ 求人数、$m/v:$ 求人の充足率、$J:$ 充足求人の期待利潤、$V:$ 未充足求人の期待利潤、$k:$ パラメータ

3. 自由参入条件は以下で定義される。

$$V=0$$

- この条件は、未充足求人の期待利潤が0になるまで、新規求人が登録されることを仮定している。

4. ナッシュ交渉

$$(1-\beta)(W-U)=\beta(J-V)$$

$\beta:$ パラメータ

- この条件は、マッチングによる余剰が、労働者と企業間でパラメータ$\beta$の割合で分配されることを仮定している。同パラメータをデータから推定することは困難であるが、以下の議論は、入職からの期待余剰$\Delta$の”変化”の識別は、$\beta$の識別を要求しないことを示している。

### 識別

- ナッシュ交渉より、入職からの余剰は以下のように書き換えられる。


$$\Delta = \underbrace{\frac{m}{u}}_{入職率}\times \underbrace{(W-U)}_{入職からの余剰}=\underbrace{\frac{m}{u}}_{入職率}\times \underbrace{\frac{\beta}{1-\beta}(J-V)}_{入職からの余剰}$$

  - 自由参入条件からさらに書き換えられる

$$\Delta = \underbrace{\frac{m}{u}}_{入職率}\times \underbrace{(W-U)}_{入職からの余剰}=\underbrace{\frac{m}{u}}_{入職率}\times \underbrace{\frac{\beta}{1-\beta}k\times\frac{v}{m}}_{入職からの余剰}$$

- 同式からは、新規就職、求人、求職件数とパラメータの積により、新規就職からの余剰は書き下せる
ことを示している。

- 未知のパラメータ($\beta$,$k$)を含んでいるため$\Delta$そのものをデータから識別することはできないが、この対数差は識別可能である。

- 異なる状態（2019年 VS 2020年, "With COVID-19" VS "Without COVID-19"等）におけるサーチ活動からの余剰を$\Delta,\Delta'$で記す。この対数差は

$$\log (\Delta) - \log(\Delta')=\underbrace{\log(\frac{m'}{u'})-\log(\frac{m}{u})}_{入職率の対数変化} + \underbrace{\log(\frac{v'}{m'})-\log(\frac{v}{m})}_{入職からの余剰の対数変化} = \log(\frac{v'}{u'})-\log(\frac{v}{u})$$

- 同式職からの余剰は、求人倍率$v/u$の対数差により識別されることを示している。

  - さらにサーチ活動からの余剰は入職率、入職からの余剰の対数変化に分解でき、それぞれも新規就職・求人・求職件数のみで識別できることを示している。

### 時系列比較への応用

- 以下では前年同月と比べたサーチ活動からの余剰変化を推定している。

  - 例えば2020年4月については、$\Delta=$ 2020年4月の余剰、$\Delta'=$ 2019年4月の余剰を示す。
  
  - 同推定値は、前年に比べて求職者が置かれている状況が、どの程度改善ないし悪化しているのかを示す指標となる。

## Rコード

```{r}
col.label <- 
   c("year",
     "1",
     "2",
     "3",
     "4",
     "5",
     "6",
     "7",
     "8",
     "9",
     "10",
     "11",
     "12",
     "type",
     "group")

select.raw <- 14:63

select.column <- c(1,3:14)

raw.vacancy.full <-
  read_excel("data/第6表.xlsx",
             sheet = "第６表ー２（パート除く）") %>%
  .[select.raw,select.column] |> 
  mutate(type = "求人",
         group = "フルタイム")

colnames(raw.vacancy.full) <- col.label

raw.seeker.full <-
  read_excel("data/第7表.xlsx",
             sheet = "第７表ー２（パート除く）") %>%
  .[select.raw,select.column] |> 
  mutate(type = "求職",
         group = "フルタイム")

colnames(raw.seeker.full) <- col.label

raw.hir.full <-
  read_excel("data/第8表.xlsx",
             sheet = "第８表ー２（パート除く）") %>%
  .[select.raw,select.column] |> 
  mutate(type = "新規就職",
         group = "フルタイム")

colnames(raw.hir.full) <- col.label


raw.vacancy.part <-
  read_excel("data/第6表.xlsx",
             sheet = "第６表ー３（パート）") %>%
  .[select.raw,select.column] |> 
  mutate(type = "求人",
         group = "パートタイム")

colnames(raw.vacancy.part) <- col.label

raw.seeker.part <-
  read_excel("data/第7表.xlsx",
             sheet = "第７表ー３（パート）") %>%
  .[select.raw,select.column] |> 
  mutate(type = "求職",
         group = "パートタイム")

colnames(raw.seeker.part) <- col.label

raw.hir.part <-
  read_excel("data/第8表.xlsx",
             sheet = "第８表ー３（パート）") %>%
  .[select.raw,select.column] |> 
  mutate(type = "新規就職",
         group = "パートタイム")

colnames(raw.hir.part) <- col.label

df <-
  rbind(raw.hir.full,
        raw.hir.part,
        raw.vacancy.full,
        raw.vacancy.part,
        raw.seeker.full,
        raw.seeker.part
        ) |> 
  pivot_longer(cols = 2:13,
               names_to = "month",
               values_to = "n") |> 
  mutate(n = n |> as.numeric(),
         year = year |> str_sub(1,4) |> as.numeric(),
         month = month |> as.numeric(),
         quaterly = month |> cut(c(0,3,6,9,12), labels = c(1,2,3,4)),
         date = yq(str_c(year,quaterly,sep = ":Q"))
         ) |> 
  group_by(date,type) |> 
  mutate(n = n |> sum()) |> 
  ungroup() |> 
  distinct(year,quaterly,date,type,n) |> 
  spread(key = type, value = n) |> 
  group_by(quaterly) |> 
  mutate(入職率 = log(新規就職/求職) - log(lag(新規就職/求職)),
        　マッチングの余剰 = log(lag(新規就職/求人)) - log(新規就職/求人),
           総余剰 = log(求人/求職) - log(lag(求人/求職))
           ) |> 
  ungroup() |> 
  select(-求職,
         -求人,
         -新規就職) |> 
  pivot_longer(cols = c(4:6),
               names_to = "type",
               values_to = "N") |> 
  na.omit()

fig <-
  df |> 
  ggplot(aes(x = date,
             y = N)
         ) +
  geom_line() +
  geom_hline(yintercept = 0) +
  facet_wrap(~factor(type,
                     levels = c("マッチングの余剰",
                                "入職率",
                                "総余剰")),
             ncol = 1) +
  ylab("") +
  xlab("") +
  theme_bw()
```

## 結果

```{r, echo = FALSE}
fig
```

